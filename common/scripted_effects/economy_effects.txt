create_random_factory_CIV_1 = {
	random_owned_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
create_random_factory_CIV_2 = {
	random_owned_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
}

create_random_factory_MIL_1 = {
	random_owned_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
create_random_factory_MIL_2 = {
	random_owned_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 1
				include_locked = yes
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
}


money_setup_scripted_effect = {
	### Income based on taxes from population and industry
	# Base value: 40% income tax for everyone which can be changed in-game
	# All these variables could be changed in-game. Would add more to the fact that we want to create something very immersive, with many possibilities

	# The total country population divided by 1000, because multiply this by 1000 and the variable breaks - gg Paradox
	set_variable = {
		total_population_k = max_manpower_k
	}

	if = {
		limit = {
			ROOT = { 
				any_owned_state = {
					is_on_continent = europe
				}
			}
		}
		## Based on Population
		# Different for every country, I took something in the middle to start with
		set_variable = {
			income_tax = 40
		}
		# Based on 13.4€ per day GROSS EARNINGS in the European Union, working 8 hours per day and 20 days a month
		set_variable = { 
			monthly_income_hourly = 13.4
		}
		set_variable = {
			works_hours_per_day = 8
		}
		set_variable = {
			average_working_days_monthly = 20
		}
		set_variable = {
			income_monthly = monthly_income_hourly
		}
		multiply_variable = {
			income_monthly = works_hours_per_day
		}
		multiply_variable = { # Should be 2112€ per month on average in the whole EU (globalized to Europe - again, not every country is the same so this either has to be changed per country, or freely set by the player during the game)
			income_monthly = average_working_days_monthly
		}
		# Divide by 1000 so the variable doesn't suicide itself, so should be 2,112€ - also fits because total population is divided by 1000 too
		divide_variable = {
			income_monthly = 1000
		}
		# This is what the state gets out of it
		set_variable = {
			income_monthly_for_country = income_monthly
		}
		divide_variable = {
			income_monthly_for_country = 100
		}
		multiply_variable = {
			income_monthly_for_country = income_tax
		}
		multiply_variable = { # Final calculation for everyone, children and elderly included I suppose, might have to be corrected
			income_monthly_for_country = total_population_k
		}

		## Based on factories - corporate taxation
		# Different for every country too, same as above - this is the european average
		set_variable = {
			corporate_tax = 21.68
		}
		set_variable = { # Random number between 1 and 5 million, divided by 1000
			corporate_income_monthly = 3311.080
		}
		set_variable = {
			corporate_income_monthly_for_country = corporate_income_monthly
		}
		divide_variable = {
			corporate_income_monthly_for_country = 100
		}
		multiply_variable = {
			corporate_income_monthly_for_country = corporate_tax
		}
		multiply_variable = { # Final calculation for all factories, civilian and military
			corporate_income_monthly_for_country = num_of_factories
		}

		## Adding everything together for a base value of money
		set_variable = {
			state_treasury = 0
		}
		add_to_variable = {
			state_treasury = income_monthly_for_country
		}
		add_to_variable = { # Final result of total money the country can use, divided by 1000
			state_treasury = corporate_income_monthly_for_country
		}

		set_variable = {
			state_treasury_show = state_treasury
		}
		divide_variable = {
			state_treasury_show = 1000
		}
	}
}

money_update_scripted_effect = {

	set_variable = {
		income_monthly = monthly_income_hourly
	}
	multiply_variable = {
		income_monthly = works_hours_per_day
	}
	multiply_variable = { 
		income_monthly = average_working_days_monthly
	}
	divide_variable = {
		income_monthly = 1000
	}
	set_variable = {
		income_monthly_for_country = income_monthly
	}
	divide_variable = {
		income_monthly_for_country = 100
	}
	multiply_variable = {
		income_monthly_for_country = income_tax
	}
	multiply_variable = {
		income_monthly_for_country = total_population_k
	}

	set_variable = {
		corporate_income_monthly_for_country = corporate_income_monthly
	}
	divide_variable = {
		corporate_income_monthly_for_country = 100
	}
	multiply_variable = {
		corporate_income_monthly_for_country = corporate_tax
	}
	multiply_variable = { # Final calculation for all factories, civilian and military
		corporate_income_monthly_for_country = num_of_factories
	}


	add_to_variable = {
		state_treasury = income_monthly_for_country
	}
	add_to_variable = {
		state_treasury = corporate_income_monthly_for_country
	}
	set_variable = {
		state_treasury_show = state_treasury
	}
	divide_variable = {
		state_treasury_show = 1000
	}
}